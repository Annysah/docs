The last step is to install Istio with the proper configuration. Deploy the Istio operator. You will need to have istioctl installed to do so:

```shell
istioctl operator init
```

<p>
  Add the proper Istio configuration changes to{' '}
  <inlineCode>{props.pzt.server.name}-istio-operator.yaml</inlineCode>. The key
  changes are to the <inlineCode>caAddress</inlineCode> and the{' '}
  <inlineCode>ENABLE_CA_SERVER</inlineCode> env. First, we point the{' '}
  <inlineCode>caAddress</inlineCode> to the istio-csr we just deployed. The
  istio-csr agent will then help Istio workload and control plane components to
  be secured using cert-manager. We also update the{' '}
  <inlineCode>ENABLE_CA_SERVER</inlineCode> env to disable istiod CA Sever
  functionality.
</p>

<CodeBlock autoCopy language="yaml">
  {`apiVersion: install.istio.io/v1alpha1
kind: IstioOperator
metadata:
 name: istio
 namespace: istio-system
spec:
 profile: "demo"
 hub: gcr.io/istio-release
 values:
   global:
     caAddress: cert-manager-istio-csr.cert-manager.svc:443
 components:
   pilot:
     k8s:
       env:
       - name: ENABLE_CA_SERVER
         value: "false"
       overlays:
       - apiVersion: apps/v1
         kind: Deployment
         name: istiod
         patches:
         - path: spec.template.spec.containers.[name:discovery].args[7]
           value: "--tlsCertFile=/etc/cert-manager/tls/tls.crt"
         - path: spec.template.spec.containers.[name:discovery].args[8]
           value: "--tlsKeyFile=/etc/cert-manager/tls/tls.key"
         - path: spec.template.spec.containers.[name:discovery].args[9]
           value: "--caCertFile=/etc/cert-manager/ca/root-cert.pem"
         - path: spec.template.spec.containers.[name:discovery].volumeMounts[6]
           value:
             name: cert-manager
             mountPath: "/etc/cert-manager/tls"
             readOnly: true
         - path: spec.template.spec.containers.[name:discovery].volumeMounts[7]
           value:
             name: ca-root-cert
             mountPath: "/etc/cert-manager/ca"
             readOnly: true
         - path: spec.template.spec.volumes[6]
           value:
             name: cert-manager
             secret:
               secretName: istiod-tls
         - path: spec.template.spec.volumes[7]
           value:
             name: ca-root-cert
             configMap:
               defaultMode: 420
               name: istio-ca-root-cert`}
</CodeBlock>

Apply the operator configurations. The controller deployed by the init command above will detect the IstioOperator resource and then install the Istio components we want.

```shell
$ kubectl apply -f istio-operator-config.yaml
```
